

Q1. Total Revenue
>>>
 SELECT SUM(ORDER_TOTAL) AS TOTAL_REVENUE FROM ORDER_DATA
 WHERE ORDER_STATUS NOT IN('CANCELLED')
 

Q2. Total Revenue by top 25 Customers
>>>
 SELECT (SUM(ORDER_TOTAL)-SUM(DISCOUNT))
 FROM ORDER_DATA
 WHERE ORDER_STATUS NOT IN('CANCELLED') AND CUSTOMER_KEY IN(
 SELECT TOP 25 CUSTOMER_KEY FROM ORDER_DATA
 ORDER BY ORDER_TOTAL DESC)

Q3. Total orders
>>>
 SELECT COUNT(ORDER_NUMBER) FROM ORDER_DATA

Q4. Total orders by top 25 customers
>>>
 SELECT COUNT(ORDER_NUMBER)
 FROM ORDER_DATA
 WHERE CUSTOMER_KEY IN(
 SELECT TOP 25 CUSTOMER_KEY FROM ORDER_DATA
 ORDER BY ORDER_TOTAL DESC)

Q5. Number of customers (Distinct)
>>>
 SELECT COUNT(*) FROM 
 (SELECT DISTINCT CUSTOMER_KEY FROM CUSTOMER_DATA) AS TT

Q6. Number of customers ordered once
>>>
 SELECT COUNT(CUSTOMER_KEY) FROM
 (SELECT CUSTOMER_KEY, COUNT(ORDER_NUMBER) NO_OF_ORDERS FROM ORDER_DATA
 GROUP BY CUSTOMER_KEY) AS TT
 WHERE NO_OF_ORDERS = 1

Q7. Number of customers ordered multiple times
>>>
  SELECT COUNT(CUSTOMER_KEY) FROM
  (SELECT CUSTOMER_KEY, COUNT(ORDER_NUMBER) NO_OF_ORDERS FROM ORDER_DATA
  GROUP BY CUSTOMER_KEY) AS TT
  WHERE NO_OF_ORDERS > 1 

Q8. Number of customers reffered to other customers
>>>
 SELECT COUNT(CUSTOMER_KEY) AS CUSTOMER_COUNT FROM CUSTOMER_DATA
 WHERE [Referred Other customers] = 'Y'

Q9. Which Month have maximum Revenue?
>>>
 SELECT TOP 1 MONTH(ORDER_DATE) AS [MONTH],SUM(ORDER_TOTAL) AS REVENUE FROM ORDER_DATA
 WHERE ORDER_STATUS NOT IN ('CANCELLED')
 GROUP BY MONTH(ORDER_DATE)
 ORDER BY REVENUE DESC

Q10. Total discount given and percentage of discount out of total revenue
>>>
 SELECT SUM(DISCOUNT) AS TOTAL_DISCOUNT,
 (SUM(DISCOUNT)/SUM(ORDER_TOTAL)*100) AS PERCENTAGE_OF_DISCOUNT
 FROM ORDER_DATA
 WHERE ORDER_STATUS NOT IN('CANCELLED')

Q11. Number of orders by month based on order status (Delivered vs. canceled vs. etc.) - Split of order status by month
>>>
 SELECT MONTH(ORDER_DATE) AS [MONTH], ORDER_STATUS, COUNT(ORDER_NUMBER) ORDER_COUNT FROM ORDER_DATA
 GROUP BY MONTH(ORDER_DATE), ORDER_STATUS
 ORDER BY MONTH(ORDER_DATE) 

Q12. Number of orders by month based on delivery status
>>>
 SELECT MONTH(ORDER_DATE) AS [MONTH], DELIVERY_STATUS, COUNT(ORDER_NUMBER) ORDER_COUNT FROM ORDER_DATA
 WHERE DELIVERY_STATUS IS NOT NULL
 GROUP BY MONTH(ORDER_DATE), DELIVERY_STATUS
 ORDER BY MONTH(ORDER_DATE) 

Q13. Month-on-month growth in order count and revenue (from Nov’15 to July’16)
>>>
 SELECT MONTH(ORDER_DATE) [MONTH], SUM(ORDER_TOTAL) AS REVENUE, COUNT(ORDER_NUMBER) AS ORDER_COUNT FROM ORDER_DATA
 WHERE ORDER_DATE BETWEEN '2015-11-1 00:00:00' AND '2016-7-31 11:59:59'
 GROUP BY MONTH(ORDER_DATE)

Q14. Month-wise split of total order value of the top 50 customers- (The top 50 customers need to identified based on their total order value)
>>>  
  SELECT MONTH(ORDER_DATE) [MONTH], SUM(ORDER_TOTAL) REVENUE FROM ORDER_DATA
 WHERE CUSTOMER_KEY IN 
 (SELECT TOP 50 CUSTOMER_KEY FROM ORDER_DATA
 GROUP BY CUSTOMER_KEY
 ORDER BY SUM(ORDER_TOTAL) DESC)
 GROUP BY MONTH(ORDER_DATE) 

Q15. Month-wise split of new and repeat customers by Gender, Location

































 

